{% extends 'base.html' %}
{% block content %}
    <h1>Create a New Bill</h1>

    <form method="POST">
        {% csrf_token %}
        {{ bill_form.as_p }}

        <label for="num_users">Number of participants:</label>
        <input type="number" id="num_users" name="num_users" min="1" max="10" required>

        <div id="user_inputs"></div>

        <button type="submit">Create Bill</button>
    </form>

    <a href="{% url 'bills' %}">Back to Bills</a>
    
    <script>
        document.getElementById('num_users').addEventListener('input', function() {
            var numUsers = parseInt(this.value);
            var userInputsDiv = document.getElementById('user_inputs');
            userInputsDiv.innerHTML = '';  

            for (var i = 0; i < numUsers; i++) {
                var userDiv = document.createElement('div');
                userDiv.classList.add('user-entry');
                
                userDiv.innerHTML = `
                    <label for="name_${i}">Participant ${i + 1} Name:</label>
                    <input type="text" name="name_${i}" id="name_${i}" required>
                    <label for="amount_spent_${i}">Amount Spent:</label>
                    <input type="number" name="amount_spent_${i}" id="amount_spent_${i}" min="0" step="0.01" required>
                `;
                
                userInputsDiv.appendChild(userDiv);
            }
        });
    </script>
{% endblock %}